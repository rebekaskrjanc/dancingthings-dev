angular.module("dancingthings",["ngRoute","ngSanitize","ui.bootstrap"]).config(["$routeProvider","$locationProvider",function(n,a){n.when("/",{templateUrl:"homepage/homepage.news.html",controller:"homepageCtrl",controllerAs:"vm"}).when("/groups",{templateUrl:"groups/pogledi/groups.pogled.html",controller:"groupsCtrl",controllerAs:"vm"}).when("/members",{templateUrl:"members/pogledi/members.pogled.html",controller:"membersCtrl",controllerAs:"vm"}).when("/myprofile",{templateUrl:"myprofile/pogledi/myprofile.pogled.html",controller:"membersCtrl",controllerAs:"vm"}).when("/signup",{templateUrl:"signup/pogledi/signup.pogled.html",controllerAs:"vm"}).when("/registracija",{templateUrl:"/avtentikacija/registracija/registracija.pogled.html",controller:"registracijaCtrl",controllerAs:"vm"}).when("/prijava",{templateUrl:"/avtentikacija/prijava/prijava.pogled.html",controller:"prijavaCtrl",controllerAs:"vm"}).when("/logout",{templateUrl:"/logout/logout.pogled.html",controllerAs:"vm"}).otherwise({redirecTo:"/"}),a.html5Mode(!0)}]),function(){function n(n,a,i,o,t){var e=this;return e.jePrijavljen=t.jePrijavljen(),e.prvotnaStran=a.path(),e.trenutniUporabnik=t.trenutniUporabnik(),e.pridobiPodatke=function(){e.sporocilo="Iščem bližnje lokacije.",o.vsebinaObjave().then(function(n){e.objave=n.data},function(n){e.sporocilo="Prišlo je do napake!",console.log(n.e)})},e.pridobiPodatke(),e.postUI=function(o,n){i.open({templateUrl:"/postModalnoOkno/postModalnoOkno.html",controller:"postModalnoOkno",controllerAs:"vm",resolve:{podrobnostiObjave:function(){return{idObjave:o,vsebina:n}}}}).result.then(function(n){if(void 0!==n)var a;for(a=0;a<e.objave.length;a++)e.objave[a]._id==o&&(e.objave[a].text=n.text,e.objave[a].postAuthor=n.postAuthor);e.pridobiPodatke()},function(n){})},e.novaObjava=function(){o.newPost({text:e.podatkiObrazca.text,imeUporabnika:e.trenutniUporabnik.username}).then(function(n){console.log("uspešno"),e.pridobiPodatke()},function(n){console.log("neuspešno",n)})},e}n.$inject=["$scope","$location","$uibModal","dancingthingsPodatki","avtentikacija"],angular.module("dancingthings").controller("homepageCtrl",n)}(),function(){function n(n,a,i,o,t){var e=this;return e.jePrijavljen=t.jePrijavljen(),e.prvotnaStran=a.path(),e.trenutniUporabnik=t.trenutniUporabnik(),e.glavaStrani={naslov:"EduGeoCache",podnaslov:"Poiščite zanimive lokacije blizu vas!"},e.pridobiSkupine=function(){o.allGroups().then(function(n){e.groups=n.data},function(n){e.sporocilo="Prišlo je do napake!",console.log(n.e)})},e.pridobiSkupine(),e.groupUI=function(){i.open({templateUrl:"/groupModalnoOkno/groupModalnoOkno.pogled.html",controller:"groupModalnoOkno",controllerAs:"vm"}).result.then(function(n){void 0!==n&&e.groups.push(n)},function(n){})},e.editGroupUI=function(o,n){i.open({templateUrl:"/editGroupModalnoOkno/editGroupModalnoOkno.html",controller:"editGroupModalnoOkno",controllerAs:"vm",resolve:{podrobnostiSkupine:function(){return{idSkupine:o,name:n}}}}).result.then(function(n){if(void 0!==n)var a;for(a=0;a<e.groups.length;a++)e.groups[a]._id==o&&(e.groups[a].groupName=n.groupName,e.groups[a].about=n.groupName);e.pridobiSkupine()},function(n){})},e}n.$inject=["$scope","$location","$uibModal","dancingthingsGroups","avtentikacija"],angular.module("dancingthings").controller("groupsCtrl",n)}(),function(){function n(n,a,i,o,t){var e=this;return e.jePrijavljen=t.jePrijavljen(),e.prvotnaStran=a.path(),e.id=0,e.name="",e.trenutniUporabnik=t.trenutniUporabnik(),console.log(e.trenutniUporabnik),e.glavaStrani={naslov:"EduGeoCache",podnaslov:"Poiščite zanimive lokacije blizu vas!"},e.pridobiUporabnike=function(){o.allMembers().then(function(n){e.users=n.data},function(n){e.sporocilo="Prišlo je do napake!",console.log(n.e)})},e.pridobiUporabnike(),e.editProfileUI=function(n,o){var a;for(e.name=o,a=0;a<n.length;a++)n[a].username==o&&(e.id=n[a]._id);i.open({templateUrl:"/editProfileModalnoOkno/editProfileModalnoOkno.html",controller:"editProfileModalnoOkno",controllerAs:"vm",resolve:{podrobnostiUporabnika:function(){return{idUporabnika:e.id}}}}).result.then(function(n){var a;for(void 0!==n&&console.log("edit podatki",n),e.trenutniUporabnik.username=n.username,e.trenutniUporabnik.email=n.email,console.log("spremenjen user",e.trenutniUporabnik),a=0;a<e.users.length;a++)e.users[a].username==o&&(e.users[a].username=n.username,e.users[a].email=n.email)},function(n){})},e}n.$inject=["$scope","$location","$uibModal","dancingthingsMembers","avtentikacija"],angular.module("dancingthings").controller("membersCtrl",n)}(),function(){function n(a,n){var o=this;o.glavaStrani={naslov:"Kreiranje novega Dancing Things uporabniškega računa"},o.prijavniPodatki={username:"",email:"",password:"",firstname:"",city:"",state:"",dance:""},o.prvotnaStran=a.search().stran||"/",o.posiljanjePodatkov=function(){if(o.napakaNaObrazcu="",!(o.prijavniPodatki.username&&o.prijavniPodatki.email&&o.prijavniPodatki.password&&o.prijavniPodatki.password2&&o.prijavniPodatki.city&&o.prijavniPodatki.state&&o.prijavniPodatki.dance&&o.prijavniPodatki.firstname))return!(o.napakaNaObrazcu="Zahtevani so vsi podatki, prosim poskusite znova!");o.izvediRegistracijo(o.prijavniPodatki)},o.izvediRegistracijo=function(){o.napakaNaObrazcu="",n.registracija(o.prijavniPodatki).then(function(n){a.search("stran",null),a.path(o.prvotnaStran)},function(n){o.napakaNaObrazcu=n.data.sporocilo})}}n.$inject=["$location","avtentikacija"],angular.module("dancingthings").controller("registracijaCtrl",n)}(),function(){function n(a,n){var o=this;o.glavaStrani={naslov:"Prijava v Dancing Things"},o.prijavniPodatki={email:"",password:""},o.prvotnaStran=a.search().stran||"/",o.posiljanjePodatkov=function(){if(o.napakaNaObrazcu="",!o.prijavniPodatki.email||!o.prijavniPodatki.password)return!(o.napakaNaObrazcu="Zahtevani so vsi podatki, prosim poskusite znova!");o.izvediPrijavo()},o.izvediPrijavo=function(){o.napakaNaObrazcu="",n.prijava(o.prijavniPodatki).then(function(n){a.search("stran",null),a.path(o.prvotnaStran)},function(n){o.napakaNaObrazcu=n.data.sporocilo})}}n.$inject=["$location","avtentikacija"],angular.module("dancingthings").controller("prijavaCtrl",n)}(),function(){function n(n,a,i,o,t){var e=this;return e.jePrijavljen=t.jePrijavljen(),e.prvotnaStran=a.path(),e.glavaStrani={naslov:"EduGeoCache",podnaslov:"Poiščite zanimive lokacije blizu vas!"},e.users,e.stranskaOrodnaVrstica="Iščete lokacijo za kratkočasenje? EduGeoCache vam pomaga pri iskanju zanimivih lokacij v bližini. Mogoče imate kakšne posebne želje? Naj vam EduGeoCache pomaga pri iskanju bližnjih zanimivih lokacij.",e.pridobiUporabnike=function(){o.allMembers().then(function(n){e.users=n.data},function(n){e.sporocilo="Prišlo je do napake!",console.log(n.e)})},e.pridobiUporabnike(),e.editProfileUI=function(o,n){console.log("bemts",o),i.open({templateUrl:"/editProfileModalnoOkno/editProfileModalnoOkno.html",controller:"editProfileModalnoOkno",controllerAs:"vm",resolve:{podrobnostiUporabnika:function(){return{idUporabnika:o}}}}).result.then(function(n){if(void 0!==n)var a;for(a=0;a<e.groups.length;a++)e.users[a]._id==o&&(e.users[a].username=n.username,e.users[a].email=n.email)},function(n){})},e}n.$inject=["$scope","$location","$uibModal","dancingthingsMembers","avtentikacija"],angular.module("dancingthings").controller("myprofileCtrl",n)}(),function(){function n(n){this.modalnoOkno={preklici:function(){n.close()}}}n.$inject=["$uibModalInstance"],angular.module("dancingthings").controller("komentarModalnoOkno",n)}(),function(){function n(n,a,o,i){var t=this;t.trenutnaLokacija=n.path(),t.jePrijavljen=i.jePrijavljen(),t.trenutniUporabnik=i.trenutniUporabnik(),t.modalnoOknoGroups={preklici:function(){a.close()},zapri:function(n){a.close(n)}},t.posiljanjePodatkov=function(){return t.napakaNaObrazcu="",t.podatkiObrazca.groupName?(t.dodajSkupino(t.podatkiObrazca),console.log(t.podatkiObrazca),!1):!(t.napakaNaObrazcu="Prosim, izpolnite vsa vnosna polja!")},t.dodajSkupino=function(n){o.newGroup({groupName:n.groupName,about:n.about,groupAdmin:t.trenutniUporabnik.username}).then(function(n){t.modalnoOknoGroups.zapri(n.data)},function(n){t.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","dancingthingsGroups","avtentikacija"],angular.module("dancingthings").controller("groupModalnoOkno",n)}(),function(){function n(n,a,o,i,t){var e=this;e.trenutnaLokacija=n.path(),e.jePrijavljen=t.jePrijavljen(),e.trenutniUporabnik=t.trenutniUporabnik(),e.podrobnostiSkupine=o,e.modalnoOknoEditGroups={preklici:function(){a.close()},zapri:function(n){a.close(n)}},e.zbrisiSkupino=function(){if(e.id=o.idSkupine,!e.id)return!(e.napakaNaObrazcu="Napačen id skupine!");i.deleteGroup(e.id).then(function(n){e.modalnoOknoEditGroups.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})},e.posiljanjePodatkov=function(n){if(e.napakaNaObrazcu="",!e.podatkiObrazca.groupName&&!e.podatkiObrazca.about)return!(e.napakaNaObrazcu="Prosim, izpolnite vsaj eno vnosno polje!");e.urediSkupino(e.podatkiObrazca,n)},e.urediSkupino=function(n,a){i.editGroup(a,{groupName:n.groupName,about:n.about}).then(function(n){e.modalnoOknoEditGroups.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","podrobnostiSkupine","dancingthingsGroups","avtentikacija"],angular.module("dancingthings").controller("editGroupModalnoOkno",n)}(),function(){function n(n,a,o,i,t){var e=this;e.trenutnaLokacija=n.path(),e.jePrijavljen=t.jePrijavljen(),e.podrobnostiUporabnika=o,e.modalnoOknoEditProfile={preklici:function(){a.close()},zapri:function(n){a.close(n)}},e.posiljanjePodatkov=function(){return e.napakaNaObrazcu="",e.podatkiObrazca.username||e.podatkiObrazca.email||e.podatkiObrazca.firstname||e.podatkiObrazca.city||e.podatkiObrazca.state||e.podatkiObrazca.dance?(e.urediUporabnika(e.podatkiObrazca),!1):!(e.napakaNaObrazcu="Prosim, izpolnite vsaj eno vnosno polje!")},e.urediUporabnika=function(n){i.editUser(e.podrobnostiUporabnika.idUporabnika,{username:n.username,firstname:n.firstname,email:n.email,city:n.city,state:n.state,dance:n.dance}).then(function(n){e.modalnoOknoEditProfile.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju uporabnika, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","podrobnostiUporabnika","dancingthingsMembers","avtentikacija"],angular.module("dancingthings").controller("editProfileModalnoOkno",n)}(),function(){function n(n,a,o,i,t){var e=this;e.trenutnaLokacija=n.path(),e.jePrijavljen=t.jePrijavljen(),e.trenutniUporabnik=t.trenutniUporabnik(),e.podrobnostiObjave=o,e.modalnoOknoPost={preklici:function(){a.close()},zapri:function(n){a.close(n)}},e.zbrisiObjavo=function(n){if(!n)return!(e.napakaNaObrazcu="Napačen id skupine!");i.deletePost(n).then(function(n){e.modalnoOknoPost.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})},e.posiljanjePodatkov=function(n){if(e.napakaNaObrazcu="",!e.podatkiObrazca.text)return!(e.napakaNaObrazcu="Prosim, izpolnite vsaj eno vnosno polje!");e.urediObjavo(e.podatkiObrazca,n)},e.urediObjavo=function(n,a){console.log("log",a,n),i.editPost(a,{text:n.text,postAuthor:e.trenutniUporabnik.username}).then(function(n){e.modalnoOknoPost.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","podrobnostiObjave","dancingthingsPodatki","avtentikacija"],angular.module("dancingthings").controller("postModalnoOkno",n)}(),function(){var n=function(o,i){return{vsebinaObjave:function(){return o.get("/api/posts")},newPost:function(n){return o.post("/api/posts",n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},editPost:function(n,a){return console.log("2. console",n,a),o.put("/api/posts/"+n,a,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},deletePost:function(n){return o.delete("/api/posts/"+n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})}}};n.$inject=["$http","avtentikacija"],angular.module("dancingthings").service("dancingthingsPodatki",n)}(),function(){var n=function(o,i){return{allGroups:function(){return o.get("/api/groups")},newGroup:function(n){return console.log(n),o.post("/api/groups",n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},editGroup:function(n,a){return o.put("/api/groups/"+n,a,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},deleteGroup:function(n){return o.delete("/api/groups/"+n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})}}};n.$inject=["$http","avtentikacija"],angular.module("dancingthings").service("dancingthingsGroups",n)}(),function(){var n=function(o,i){return{allMembers:function(){return o.get("/api/users")},newMember:function(n){return o.post("/api/users",n)},editUser:function(n,a){return o.put("/api/users/"+n,a,{headers:{Authorization:"Bearer "+i.vrniZeton()}})}}};n.$inject=["$http","avtentikacija"],angular.module("dancingthings").service("dancingthingsMembers",n)}(),function(){function n(a,o){var i=function(n){return decodeURIComponent(Array.prototype.map.call(a.atob(n),function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""))},t=function(n){a.localStorage["dancingthings-zeton"]=n},e=function(){return a.localStorage["dancingthings-zeton"]},r=function(){var n=e();return!!n&&JSON.parse(i(n.split(".")[1])).datumPoteka>Date.now()/1e3};return{shraniZeton:t,vrniZeton:e,registracija:function(n){return o.post("/api/registracija",n).then(function(n){t(n.data.zeton)})},prijava:function(n){return o.post("/api/prijava",n).then(function(n){t(n.data.zeton)})},odjava:function(){a.localStorage.removeItem("dancingthings-zeton")},jePrijavljen:r,trenutniUporabnik:function(){if(r()){var n=e(),a=JSON.parse(i(n.split(".")[1]));return console.log("koristna vsebin",a),{email:a.email,username:a.username,firstname:a.firstname,city:a.city,state:a.state,dance:a.dance}}}}}n.$inject=["$window","$http"],angular.module("dancingthings").service("avtentikacija",n)}(),angular.module("dancingthings").filter("dodajHtmlPrehodVNovoVrstico",function(){return function(n){return n.replace(/\n/g,"<br/>")}}),angular.module("dancingthings").directive("noga",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/noga/noga.predloga.html"}}),angular.module("dancingthings").directive("navigacija",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/navigacija/navigacija.predloga.html",controller:"navigacijaCtrl",controllerAs:"navvm"}}),function(){function n(n,a,o){this.trenutnaLokacija=n.path(),this.jePrijavljen=a.jePrijavljen(),this.trenutniUporabnik=a.trenutniUporabnik(),this.odjava=function(){a.odjava(),n.path("/"),o.reload()}}n.$inject=["$location","avtentikacija","$route"],angular.module("dancingthings").controller("navigacijaCtrl",n)}(),angular.module("dancingthings").directive("glava",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/glava/glava.predloga.html"}}),angular.module("dancingthings").directive("signout",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/signout/signout.predloga.html",controller:"signoutCtrl",controllerAs:"navvm"}}),function(){function n(n,a,o){this.trenutnaLokacija=n.path(),this.jePrijavljen=a.jePrijavljen(),this.trenutniUporabnik=a.trenutniUporabnik(),this.odjava=function(){a.odjava(),n.path("/"),o.reload()}}n.$inject=["$location","avtentikacija","$route"],angular.module("dancingthings").controller("signoutCtrl",n)}();