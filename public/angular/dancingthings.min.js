angular.module("dancingthings",["ngRoute","ngSanitize","ui.bootstrap"]).config(["$routeProvider","$locationProvider",function(n,o){n.when("/",{templateUrl:"homepage/homepage.news.html",controller:"homepageCtrl",controllerAs:"vm"}).when("/groups",{templateUrl:"groups/pogledi/groups.pogled.html",controller:"groupsCtrl",controllerAs:"vm"}).when("/members",{templateUrl:"members/pogledi/members.pogled.html",controller:"membersCtrl",controllerAs:"vm"}).when("/myprofile",{templateUrl:"myprofile/pogledi/myprofile.pogled.html",controller:"membersCtrl",controllerAs:"vm"}).when("/signup",{templateUrl:"signup/pogledi/signup.pogled.html",controllerAs:"vm"}).when("/registracija",{templateUrl:"/avtentikacija/registracija/registracija.pogled.html",controller:"registracijaCtrl",controllerAs:"vm"}).when("/prijava",{templateUrl:"/avtentikacija/prijava/prijava.pogled.html",controller:"prijavaCtrl",controllerAs:"vm"}).when("/logout",{templateUrl:"/logout/logout.pogled.html",controllerAs:"vm"}).when("/db",{templateUrl:"/db/db.html",controllerAs:"vm"}).otherwise({redirecTo:"/"}),o.html5Mode(!0)}]),function(){function n(n,o,t,a,i,e,r){var l=this;return l.jePrijavljen=i.jePrijavljen(),l.prvotnaStran=o.path(),l.trenutniUporabnik=i.trenutniUporabnik(),console.log(l.trenutniUporabnik),l.pridobiPodatke=function(){l.sporocilo="Iščem bližnje lokacije.",a.vsebinaObjave().then(function(n){var o;for(l.objave=n.data,o=0;o<l.objave.length;o++)coms=l.objave[o].comments+"",coms=coms.split(","),l.objave[o].comments=coms;l.objave.comments},function(n){l.sporocilo="Prišlo je do napake!",console.log(n.e)})},l.pridobiPodatke(),l.postUI=function(a,n){t.open({templateUrl:"/postModalnoOkno/postModalnoOkno.html",controller:"postModalnoOkno",controllerAs:"vm",resolve:{podrobnostiObjave:function(){return{idObjave:a,vsebina:n}}}}).result.then(function(n){if(void 0!==n)var o;for(o=0;o<l.objave.length;o++)l.objave[o]._id==a&&(l.objave[o].text=n.text,l.objave[o].postAuthor=n.postAuthor);l.pridobiPodatke()},function(n){})},l.novaObjava=function(){a.newPost({text:l.podatkiObrazca.text,imeUporabnika:l.trenutniUporabnik.username}).then(function(n){console.log("uspešno"),l.pridobiPodatke()},function(n){console.log("neuspešno",n)})},l.novKomentar=function(a,n,o,i){t.open({templateUrl:"/commentModalnoOkno/commentModalnoOkno.html",controller:"commentModalnoOkno",controllerAs:"vm",resolve:{podrobnostiKom:function(){return{idObjave:a,komentarji:n,vsebina:o,author:i}}}}).result.then(function(n){var o;if(c=n.comments.split(","),void 0!==n)for(o=0;o<l.objave.length;o++)l.objave[o]._id==a&&(l.objave[o].comments=c)},function(n){})},l.pridobiUporabnike=function(){e.allMembers().then(function(n){l.users=n.data},function(n){l.sporocilo="Prišlo je do napake!",console.log(n.e)})},l.pridobiUporabnike(),l.pridobiSkupine=function(){r.allGroups().then(function(n){l.groups=n.data},function(n){l.sporocilo="Prišlo je do napake!",console.log(n.e)})},l.pridobiSkupine(),l}n.$inject=["$scope","$location","$uibModal","dancingthingsPodatki","avtentikacija","dancingthingsMembers","dancingthingsGroups"],angular.module("dancingthings").controller("homepageCtrl",n)}(),function(){function n(n,o,i,a,t){var e=this;return e.jePrijavljen=t.jePrijavljen(),e.prvotnaStran=o.path(),e.trenutniUporabnik=t.trenutniUporabnik(),e.glavaStrani={naslov:"EduGeoCache",podnaslov:"Poiščite zanimive lokacije blizu vas!"},e.pridobiSkupine=function(){a.allGroups().then(function(n){e.groups=n.data},function(n){e.sporocilo="Prišlo je do napake!",console.log(n.e)})},e.pridobiSkupine(),e.groupUI=function(){i.open({templateUrl:"/groupModalnoOkno/groupModalnoOkno.pogled.html",controller:"groupModalnoOkno",controllerAs:"vm"}).result.then(function(n){void 0!==n&&e.groups.push(n)},function(n){})},e.editGroupUI=function(a,n){i.open({templateUrl:"/editGroupModalnoOkno/editGroupModalnoOkno.html",controller:"editGroupModalnoOkno",controllerAs:"vm",resolve:{podrobnostiSkupine:function(){return{idSkupine:a,name:n}}}}).result.then(function(n){if(void 0!==n)var o;for(o=0;o<e.groups.length;o++)e.groups[o]._id==a&&(e.groups[o].groupName=n.groupName,e.groups[o].about=n.groupName);e.pridobiSkupine()},function(n){})},e}n.$inject=["$scope","$location","$uibModal","dancingthingsGroups","avtentikacija"],angular.module("dancingthings").controller("groupsCtrl",n)}(),function(){function n(n,o,i,a,t,e){var r=this;return r.jePrijavljen=e.jePrijavljen(),r.prvotnaStran=o.path(),r.id=0,r.name="",r.nalaganje="Loading posts.",r.trenutniUporabnik=e.trenutniUporabnik(),r.glavaStrani={naslov:"EduGeoCache",podnaslov:"Poiščite zanimive lokacije blizu vas!"},r.pridobiUporabnike=function(){a.allMembers().then(function(n){r.users=n.data},function(n){r.sporocilo="Prišlo je do napake!",console.log(n.e)})},r.pridobiUporabnike(),r.pridobiPodatke=function(){r.sporocilo="Iščem bližnje lokacije.",t.vsebinaObjave().then(function(n){var o;for(r.objave=n.data,o=0;o<r.objave.length;o++)coms=r.objave[o].comments+"",coms=coms.split(","),r.objave[o].comments=coms;r.objave.comments},function(n){r.sporocilo="Prišlo je do napake!",console.log(n.e)})},r.pridobiPodatke(),r.editProfileUI=function(n,a){var o;for(r.name=a,o=0;o<n.length;o++)n[o].username==a&&(r.id=n[o]._id);i.open({templateUrl:"/editProfileModalnoOkno/editProfileModalnoOkno.html",controller:"editProfileModalnoOkno",controllerAs:"vm",resolve:{podrobnostiUporabnika:function(){return{idUporabnika:r.id}}}}).result.then(function(n){var o;for(void 0!==n&&console.log("edit podatki",n),r.trenutniUporabnik.username=n.username,r.trenutniUporabnik.email=n.email,console.log("spremenjen user",r.trenutniUporabnik),o=0;o<r.users.length;o++)r.users[o].username==a&&(r.users[o].username=n.username,r.users[o].email=n.email)},function(n){})},r}n.$inject=["$scope","$location","$uibModal","dancingthingsMembers","dancingthingsPodatki","avtentikacija"],angular.module("dancingthings").controller("membersCtrl",n)}(),function(){function n(o,a){var i=this;i.glavaStrani={naslov:"Kreiranje novega Dancing Things uporabniškega računa"},i.prijavniPodatki={username:"",email:"",password:"",firstname:"",city:"",state:"",dance:""},i.prvotnaStran=o.search().stran||"/",i.posiljanjePodatkov=function(n){if(console.log(n),i.prijavniPodatki.dance=n,console.log("prijavni podatki",i.prijavniPodatki),i.napakaNaObrazcu="",!(i.prijavniPodatki.username&&i.prijavniPodatki.email&&i.prijavniPodatki.password&&i.prijavniPodatki.password2&&i.prijavniPodatki.city&&i.prijavniPodatki.state&&i.prijavniPodatki.dance&&i.prijavniPodatki.firstname))return!(i.napakaNaObrazcu="Zahtevani so vsi podatki, prosim poskusite znova!");i.izvediRegistracijo(i.prijavniPodatki)},i.izvediRegistracijo=function(n){console.log("izvajamR",n),i.napakaNaObrazcu="",a.registracija(n).then(function(n){o.search("stran",null),o.path(i.prvotnaStran)},function(n){i.napakaNaObrazcu=n.data.sporocilo})}}n.$inject=["$location","avtentikacija"],angular.module("dancingthings").controller("registracijaCtrl",n)}(),function(){function n(o,n){var a=this;a.glavaStrani={naslov:"Prijava v Dancing Things"},a.prijavniPodatki={email:"",password:""},a.prvotnaStran=o.search().stran||"/",a.posiljanjePodatkov=function(){if(a.napakaNaObrazcu="",!a.prijavniPodatki.email||!a.prijavniPodatki.password)return!(a.napakaNaObrazcu="Zahtevani so vsi podatki, prosim poskusite znova!");a.izvediPrijavo()},a.izvediPrijavo=function(){a.napakaNaObrazcu="",n.prijava(a.prijavniPodatki).then(function(n){o.search("stran",null),o.path(a.prvotnaStran)},function(n){a.napakaNaObrazcu=n.data.sporocilo})}}n.$inject=["$location","avtentikacija"],angular.module("dancingthings").controller("prijavaCtrl",n)}(),function(){function n(n,o,a,i,t){var e=this;return e.jePrijavljen=t.jePrijavljen(),e.prvotnaStran=o.path(),e.glavaStrani={naslov:"EduGeoCache",podnaslov:"Poiščite zanimive lokacije blizu vas!"},e.users,e.stranskaOrodnaVrstica="Iščete lokacijo za kratkočasenje? EduGeoCache vam pomaga pri iskanju zanimivih lokacij v bližini. Mogoče imate kakšne posebne želje? Naj vam EduGeoCache pomaga pri iskanju bližnjih zanimivih lokacij.",e.pridobiUporabnike=function(){i.allMembers().then(function(n){e.users=n.data},function(n){e.sporocilo="Prišlo je do napake!",console.log(n.e)})},e.pridobiUporabnike(),e}n.$inject=["$scope","$location","$uibModal","dancingthingsMembers","avtentikacija"],angular.module("dancingthings").controller("myprofileCtrl",n)}(),function(){function n(n){this.modalnoOkno={preklici:function(){n.close()}}}n.$inject=["$uibModalInstance"],angular.module("dancingthings").controller("komentarModalnoOkno",n)}(),function(){function n(n,o,a,i){var t=this;t.trenutnaLokacija=n.path(),t.jePrijavljen=i.jePrijavljen(),t.trenutniUporabnik=i.trenutniUporabnik(),t.modalnoOknoGroups={preklici:function(){o.close()},zapri:function(n){o.close(n)}},t.posiljanjePodatkov=function(){return t.napakaNaObrazcu="",t.podatkiObrazca.groupName?(t.dodajSkupino(t.podatkiObrazca),console.log(t.podatkiObrazca),!1):!(t.napakaNaObrazcu="Prosim, izpolnite vsa vnosna polja!")},t.dodajSkupino=function(n){a.newGroup({groupName:n.groupName,about:n.about,groupAdmin:t.trenutniUporabnik.username}).then(function(n){t.modalnoOknoGroups.zapri(n.data)},function(n){t.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","dancingthingsGroups","avtentikacija"],angular.module("dancingthings").controller("groupModalnoOkno",n)}(),function(){function n(n,o,a,i,t){var e=this;e.trenutnaLokacija=n.path(),e.jePrijavljen=t.jePrijavljen(),e.trenutniUporabnik=t.trenutniUporabnik(),e.podrobnostiSkupine=a,e.modalnoOknoEditGroups={preklici:function(){o.close()},zapri:function(n){o.close(n)}},e.zbrisiSkupino=function(){if(e.id=a.idSkupine,!e.id)return!(e.napakaNaObrazcu="Napačen id skupine!");i.deleteGroup(e.id).then(function(n){e.modalnoOknoEditGroups.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})},e.posiljanjePodatkov=function(n){if(e.napakaNaObrazcu="",!e.podatkiObrazca.groupName&&!e.podatkiObrazca.about)return!(e.napakaNaObrazcu="Prosim, izpolnite vsaj eno vnosno polje!");e.urediSkupino(e.podatkiObrazca,n)},e.urediSkupino=function(n,o){i.editGroup(o,{groupName:n.groupName,about:n.about}).then(function(n){e.modalnoOknoEditGroups.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","podrobnostiSkupine","dancingthingsGroups","avtentikacija"],angular.module("dancingthings").controller("editGroupModalnoOkno",n)}(),function(){function n(n,o,a,i,t){var e=this;e.trenutnaLokacija=n.path(),e.jePrijavljen=t.jePrijavljen(),e.trenutniUporabnik=t.trenutniUporabnik(),e.podrobnostiObjave=a,e.modalnoOknoPost={preklici:function(){o.close()},zapri:function(n){o.close(n)}},e.zbrisiObjavo=function(n){if(!n)return!(e.napakaNaObrazcu="Napačen id skupine!");i.deletePost(n).then(function(n){e.modalnoOknoPost.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})},e.posiljanjePodatkov=function(n,o){if(e.napakaNaObrazcu="",!e.podatkiObrazca.text)return!(e.napakaNaObrazcu="Prosim, izpolnite vsaj eno vnosno polje!");e.urediObjavo(e.podatkiObrazca,n,o)},e.urediObjavo=function(n,o,a){console.log("log",o,n),i.editPost(o,{text:n.text,postAuthor:a}).then(function(n){e.modalnoOknoPost.zapri(n.data)},function(n){e.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","podrobnostiObjave","dancingthingsPodatki","avtentikacija"],angular.module("dancingthings").controller("postModalnoOkno",n)}(),function(){function n(n,o,a,e,i){var r=this;r.trenutnaLokacija=n.path(),r.jePrijavljen=i.jePrijavljen(),r.trenutniUporabnik=i.trenutniUporabnik(),r.podrobnostiKom=a,r.modalnoOknoComment={preklici:function(){o.close()},zapri:function(n){o.close(n)}},r.zbrisiObjavo=function(n,o){if(console.log("prvi",n,o),!n)return!(r.napakaNaObrazcu="Napačen id skupine!");e.deletePost(n).then(function(n){r.modalnoOknoComment.zapri(n.data)},function(n){r.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})},r.posiljanjePodatkov=function(n,o,a,i){if(r.napakaNaObrazcu="",!r.podatkiObrazca.text)return!(r.napakaNaObrazcu="Prosim, izpolnite vsaj eno vnosno polje!");console.log("drugi",n,o,a,i),r.urediObjavo(r.podatkiObrazca,n,a,o,i)},r.urediObjavo=function(n,o,a,i,t){console.log("author",t),""==i?e.editPost(o,{text:a,postAuthor:t,comments:n.text}).then(function(n){console.log("data",n.data),r.modalnoOknoComment.zapri(n.data)},function(n){r.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"}):e.editPost(o,{text:a,postAuthor:t,comments:i+","+n.text}).then(function(n){r.modalnoOknoComment.zapri(n.data)},function(n){r.napakaNaObrazcu="Napaka pri shranjevanju skupine, poskusite znova!"})}}n.$inject=["$location","$uibModalInstance","podrobnostiKom","dancingthingsPodatki","avtentikacija"],angular.module("dancingthings").controller("commentModalnoOkno",n)}(),function(){var n=function(a,i){return{vsebinaObjave:function(){return a.get("/api/posts")},newPost:function(n){return a.post("/api/posts",n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},editPost:function(n,o){return console.log("2. console",n,o),a.put("/api/posts/"+n,o,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},deletePost:function(n){return a.delete("/api/posts/"+n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})}}};n.$inject=["$http","avtentikacija"],angular.module("dancingthings").service("dancingthingsPodatki",n)}(),function(){var n=function(a,i){return{allGroups:function(){return a.get("/api/groups")},newGroup:function(n){return console.log(n),a.post("/api/groups",n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},editGroup:function(n,o){return a.put("/api/groups/"+n,o,{headers:{Authorization:"Bearer "+i.vrniZeton()}})},deleteGroup:function(n){return a.delete("/api/groups/"+n,{headers:{Authorization:"Bearer "+i.vrniZeton()}})}}};n.$inject=["$http","avtentikacija"],angular.module("dancingthings").service("dancingthingsGroups",n)}(),function(){var n=function(a,i){return{allMembers:function(){return a.get("/api/users")},newMember:function(n){return a.post("/api/users",n)},editUser:function(n,o){return a.put("/api/users/"+n,o,{headers:{Authorization:"Bearer "+i.vrniZeton()}})}}};n.$inject=["$http","avtentikacija"],angular.module("dancingthings").service("dancingthingsMembers",n)}(),function(){function n(o,a){var i=function(n){return decodeURIComponent(Array.prototype.map.call(o.atob(n),function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""))},t=function(n){o.localStorage["dancingthings-zeton"]=n},e=function(){return o.localStorage["dancingthings-zeton"]},r=function(){var n=e();return!!n&&JSON.parse(i(n.split(".")[1])).datumPoteka>Date.now()/1e3};return{shraniZeton:t,vrniZeton:e,registracija:function(n){return console.log("storitev",n),a.post("/api/registracija",n).then(function(n){console.log("po apiju",n.data),t(n.data.zeton)})},prijava:function(n){return a.post("/api/prijava",n).then(function(n){t(n.data.zeton)})},odjava:function(){o.localStorage.removeItem("dancingthings-zeton")},jePrijavljen:r,trenutniUporabnik:function(){if(console.log("koristna vsebina",o),r()){var n=e(),o=JSON.parse(i(n.split(".")[1]));return{email:o.email,username:o.username,firstname:o.firstname,city:o.city,state:o.state,dance:o.dance}}}}}n.$inject=["$window","$http"],angular.module("dancingthings").service("avtentikacija",n)}(),angular.module("dancingthings").filter("dodajHtmlPrehodVNovoVrstico",function(){return function(n){return n.replace(/\n/g,"<br/>")}}),angular.module("dancingthings").directive("noga",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/noga/noga.predloga.html"}}),angular.module("dancingthings").directive("navigacija",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/navigacija/navigacija.predloga.html",controller:"navigacijaCtrl",controllerAs:"navvm"}}),function(){function n(n,o,a){this.trenutnaLokacija=n.path(),this.jePrijavljen=o.jePrijavljen(),this.trenutniUporabnik=o.trenutniUporabnik(),this.odjava=function(){o.odjava(),n.path("/"),a.reload()}}n.$inject=["$location","avtentikacija","$route"],angular.module("dancingthings").controller("navigacijaCtrl",n)}(),angular.module("dancingthings").directive("glava",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/glava/glava.predloga.html"}}),angular.module("dancingthings").directive("signout",function(){return{restrict:"EA",templateUrl:"/skupno/direktive/signout/signout.predloga.html",controller:"signoutCtrl",controllerAs:"navvm"}}),function(){function n(n,o,a){this.trenutnaLokacija=n.path(),this.jePrijavljen=o.jePrijavljen(),this.trenutniUporabnik=o.trenutniUporabnik(),this.odjava=function(){o.odjava(),n.path("/"),a.reload()}}n.$inject=["$location","avtentikacija","$route"],angular.module("dancingthings").controller("signoutCtrl",n)}();